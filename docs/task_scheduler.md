# `task_scheduler` - 任务调度器

简单的任务调度器，参考了 kmk_firmware 项目中使用的任务调度器。

利用 _asyncio 中的 TaskQueue 配对堆实现。

这些内容原本是为了 uasyncio 模块服务的，所以没有良好的文档记录。

系统核心，任务调度由它负责。

提供系统负载计算。

## TASKEXIT 常量

任务函数可以通过返回此常量令任务主动退出。

## Task(self, func, period, oneshot=False) 类

任务，实例化该类即创建任务，任务创建后默认为停止状态。

参数 func 为可调用对象，也就是任务函数，会按照一定周期运行。此函数执行耗时不能太长，否则可能导致整个系统卡死。不能包含死循环，如果需要循环执行，请把循环体单独拿出来作为任务函数。

参数 period 为运行周期，以毫秒为单位，不能太长。

参数 oneshot 标明任务是否为一次性任务，如果是，则等待 period 毫秒后执行一次，否则以 period 毫秒为周期重复执行。

### start(self)

启动任务。

### stop(self)

停止任务。

### set_args(self, *args, **kwargs)

配置任务参数，如果任务函数需要参数，则创建任务后，可通过这个函数传递参数给任务函数。如果任务已经启动，则不会有任何效果。

### set_period(self, period)

配置任务周期。如果任务已经启动，则不会有任何效果。

### start_with_arg(self, *args, **kwargs)

设置任务参数并启动，相当于依次调用 set_args 和 start. 如果任务已经启动，则不会有任何效果。

## get_sys_load_info()

获取 10 秒内系统负载信息，返回一个元组，内容依次为：系统负载（% ），总有效运行时间（ms），当前空闲内存（Byte）。
